<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<link rel="icon" type="image/png" href="./images/favicon-32x32.png" sizes="32x32" />
	<link rel="icon" type="image/png" href="./images/favicon-16x16.png" sizes="16x16" />
        <title>Emacs Learning - SPK's Rationality Essays</title>
        <link rel="stylesheet" type="text/css" href="./css/default.css" />
        <link rel="stylesheet" type="text/css" href="./css/highlight.css" />

	<!-- <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script> -->
	<!-- <script type="text/javascript" src="/js/header-links.js"></script> -->
	<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

	<link href="atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM/RSS Feed" />

	<!-- Google Analytics stuff -->
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-51321929-1', 'pradeep90.github.io');
	  ga('send', 'pageview');

	</script>

    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="./">SPK's Rationality Essays</a>
            </div>
            <div id="navigation">
                <a href="./">Home</a>
                <a href="./notes.html">Notes</a>
                <!-- <a href="/about.html">About</a> -->
                <a href="./archive.html">Archive</a>
		<a href="./atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM/RSS Feed">RSS</a>
            </div>
        </div>

        <div id="content">
          <h1 id="post-title">Emacs Learning</h1>

            <!-- <center><img src="https://fbcdn-sphotos-d-a.akamaihd.net/hphotos-ak-prn1/t31.0-8/p600x600/10257116_10202295769100492_2438594605053717342_o.jpg" height="400" width="300" class="sujeet-pic" alt="Sujeet pic" /></center> -->

<h1 id="docstring">Docstring</h1>
<p>I think you shouldn’t leave a blank line between the first line of the docstring and the next. I wrote all my elisp functions like that for the last four years :P</p>
<h1 id="shell">Shell</h1>
<ul>
<li><p>TODO Get the Emacs shell to have proper PATH and completion (maybe)</p>
<p>sum-column should work</p></li>
</ul>
<h1 id="dired">Dired</h1>
<p>Q on marked buffers seems to crash Emacs at the end. It has happened five times now (in my website directory).</p>
<h1 id="emacs-lisp-hacking">Emacs Lisp Hacking</h1>
<p>Check out <code>testcover</code> or <code>edebug</code> for test coverage.</p>
<h1 id="dired-1">Dired</h1>
<p>wdired: When doing <code>query-replace-regexp</code> on the file names, you have to be careful not to match anything other than the filename. Otherwise, you match some of the permission data or the owner data, which are read only. And since <code>query-replace-skip-read-only</code> is on, <code>query-replace-regexp</code> skips those matches.</p>
<h1 id="dot-emacs">Dot Emacs</h1>
<p>“Never use load or require” - <a href="http://a-nickels-worth.blogspot.in/2007/11/effective-emacs.html">Effective .emacs</a>. He recommends using <code>autoload</code> and <code>eval-after-load</code> instead.</p>
<h1 id="magit">Magit</h1>
<blockquote>
<p>Almost all the actions you can carry out in Magit is done through a one-key system that opens up a “command console” window at the bottom, letting you further refine your command before you carry it out. This is a fantastically well-done interface and is probably the killer feature that makes Magit so great. I like it so much that I have copied the underlying interface code for use in some of my own Emacs hackery. It’s really, really nice.</p>
<p>– <a href="https://www.masteringemacs.org/article/introduction-magit-emacs-mode-git">Mastering Emacs</a></p>
</blockquote>
<h1 id="helm">Helm</h1>
<p>Looks awesome! I had my reservations, but it’s blowing my mind with the consistent interface to my files, buffers, bookmarks, imenu items, man entries, etc.</p>
<h1 id="haskell">Haskell</h1>
<p>Get <a href="http://www.mew.org/~kazu/proj/ghc-mod/en/preparation.html">ghc-mode</a>.</p>
<p>Also <a href="https://www.reddit.com/r/haskell/comments/3kr6m3/update_i_got_spacemacs_working_using_stack_with/">other</a> cool haskell stuff.</p>
<p>Structured Haskell Mode is pretty sweet. It lets you do paredit-like edits, such as going from</p>
<pre><code>hGetContents =&lt;&lt; openFile [cursor]&quot;dictionary.txt&quot; ReadMode</code></pre>
<p>to</p>
<pre><code>&quot;dictionary.txt&quot;</code></pre>
<h1 id="screen-lag-in-large-markdown-buffers">Screen Lag in Large Markdown Buffers</h1>
<p>The screen definitely lags when I type in a Markdown buffer with ~24k words, but not when I narrow the buffer to just one small section of 34 words.</p>
<p>Could be because I have large paragraphs (which look to Emacs like large lines). Or it could just be the size of the buffer.</p>
<p>(I think a similar effect occurs even in smaller Markdown buffers.)</p>
<h1 id="markdown-forward-paragraph-leading-spaces-hang">Markdown + forward-paragraph + leading spaces = Hang</h1>
<p><strong>Experiment</strong>: Took a new markdown buffer. Wrote “foo”.</p>
<ul>
<li><p>Added 20 spaces in front of it. Significant lag, especially when moving point. But I’m able to type afterwards.</p></li>
<li><p>Added 35 spaces. Hung.</p></li>
</ul>
<p><strong>Observation</strong>: The word count indicator in the mode line was absent when I pressed C-g to stop Emacs hanging.</p>
<p><strong>Hypothesis</strong>: Could it be because of <code>wc-mode</code>?</p>
<p><strong>Experiment</strong>: You bet!</p>
<ul>
<li>Turned it off. Added 100 spaces. No problem.</li>
</ul>
<p><code>wc-mode</code> calls <code>count-words-in-paragraph</code>. Is it because of that function? Yup.</p>
<p>It hangs when I say <code>(count-words-in-paragraph)</code> near the line with leading spaces.</p>
<p>It’s mark-paragraph that hangs!</p>
<p>Digging further: it’s forward-paragraph that hangs!</p>
<p>All this because of one observation - the word count stat in the mode-line was missing!</p>
<p><strong>Experiment</strong>: The above doesn’t happen with a <code>text-mode</code> buffer with <code>wc-mode</code> turned on.</p>
<p>So, the problem is with <code>forward-paragraph</code> in Markdown.</p>
<p><strong>Experiment</strong>: A long sequence of spaces <em>anywhere</em> is a problem.</p>
<ul>
<li>23 spaces between “fo” and “o” hangs Markdown.</li>
</ul>
<h1 id="ispell">Ispell</h1>
<p>Set your personal dictionary file so that your words are saved.</p>
<pre><code>(setq ispell-personal-dictionary &quot;~/.ispell_pradeep_laptop&quot;)</code></pre>
<h1 id="upgrading-from-emacs-24.3-to-25.3">Upgrading from Emacs 24.3 to 25.3</h1>
<p>What still doesn’t work:</p>
<p>log-edit-done - doesn’t show diff and fails when I try to commit.</p>
<pre><code>log-edit-show-diff: Diff functionality has not been setup

Wrong type argument: commandp, nil</code></pre>
<p>This is because of the following code in log-edit.el.gz:</p>
<pre><code>(defvar log-edit-callback nil)
(defvar log-edit-diff-function nil)</code></pre>
<p>I’m guessing that Git backend support has somehow not been set up.</p>
<p>[2018-01-04 Thu] Haven’t had any such problems since then. Don’t know why.</p>
<h1 id="writing-your-own-elisp-packages">Writing your own Elisp Packages</h1>
<p>I wrote <code>org-autoclock.el</code>. It’s not yet a package that can be installed via the package manager, but it is a working standalone file.</p>
<p>But I failed to require <code>org</code> and <code>s</code> and <code>f</code>, which the code needed and which worked in my setup because I had already required them. So, naturally, when my friend tried to use <code>org-autoclock</code>, it blew up. Bad.</p>
<p><strong>Lesson</strong>: Run your proposed elisp code in an isolated Emacs instance so that you see which dependencies you need.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">emacs</span> -Q -l org-autoclock.el</code></pre></div>
<p>Observation: When Emacs doesn’t know the definition of some function, it just skips it or something.</p>
<h1 id="opening-files-as-root">Opening Files as Root</h1>
<p>To manipulate a file (say <code>/etc/apt/sources.list</code>) with sudo permissions:</p>
<pre><code># ido will provide completion.
C-x C-f RET /sudo:root@localhost:/etc/apt/sources.list/</code></pre>
<h1 id="calc">Calc</h1>
<h2 id="recompute-an-expression-for-different-values">Recompute an Expression for Different Values</h2>
<p>To calculate the compound interest formula <code>a * (1 + r / 100)^t</code> for different values of r and t and a, do</p>
<pre><code>'a * (1 + r/100)^t =&gt;</code></pre>
<p>The <code>=&gt;</code> tells Calc that you want it to recompute that expression every time you set a value to one of its variables.</p>
<p>So, you can do</p>
<pre><code>ss a = 3336
ss t = 10
ss r = 10</code></pre>
<p>to see</p>
<pre><code>1:  a*(r / 100 + 1)^t =&gt; 8652.72484689</code></pre>
<p>Change the rate r</p>
<pre><code>ss r = 20</code></pre>
<p>to see</p>
<pre><code>1:  a*(r / 100 + 1)^t =&gt; 20655.6327051</code></pre>
<h2 id="financial-functions">Financial functions</h2>
<p>h/t: Andrew Hyatt’s post at https://plus.google.com/+AndrewHyatt/posts/YdwsbNmZ4NL</p>
<p>The examples are from the excellent Emacs Calc manual. And, yes, they were right - I suddenly got a better grasp of present value after reading the manual pages (8.6.3 Present Value)</p>
<p>If you start out with a lump sum of $6479 and get 9% interest for 4 years, you would end up with a final amount of $9146. So, the “future value of a lump sum” of $6479 at 9% after 4 years is $9146.</p>
<pre><code>fvl(9%, 4, 6479.44) =&gt; 9146.2583471</code></pre>
<p>If get $2000 each year from an investment (and then put it in a bank at 9%) for 4 years, you would have to start out with $6479 to get what that would earn in 4 years from something earning 9% interest. Put differently, the “present value of benefits” of $2000 each year for 4 years at an interest rate of 9% is $6479.</p>
<pre><code>pv(9%, 4, 2000) =&gt; 6479.44</code></pre>
<p>If you pay $2000 each year for 4 years and get 9% interest, then your final amount would be $9146. This is probably “future value of installments”.</p>
<pre><code>fv(9%, 4, 2000) =&gt; 9146.258</code></pre>
<p>If you take a loan of $6479 right now, you would have to pay $2000 each year so that the lender would get that much at the end of 4 years by saving it from the beginning at 9%. Basically, the present value of your periodic payments is $6479. Use <code>pmt</code> to calculate the periodic payments.</p>
<pre><code>pmt(9%, 4, 6479.44) =&gt; 2000.0000759</code></pre>
<p>Number of periodic payments needed to make the present value of $2000 per year equal $6479: use <code>nper</code>.</p>
<pre><code>nper(9%, 2000, 6479) =&gt;  3.99967586385</code></pre>
<p>Rate at which you would have got a present value of $6479 from payments of $2000 for 4 years: use <code>rate</code>.</p>
<pre><code>rate(4, 2000, 6479) =&gt;  0.0900309222001 (9%)</code></pre>
<p>Rate at which you would get $9146 from a lump sum $6479 after 4 years: use <code>ratel</code>.</p>
<pre><code>ratel(4, 9146, 6479) =&gt;  0.0900108081676 (9%)</code></pre>
<p>Net present value of a series of irregular investments when you could have invested them at 9%: use <code>npv</code>. (Here I’m copying the example for 4 equal payments of $2000.)</p>
<pre><code>npv(9%, [2000, 2000, 2000, 2000]) =&gt;  6479.43975411</code></pre>
<p>Rate of interest that would have got you the same final amount as a bunch of irregular payments: use <code>irr</code>.</p>
<pre><code>[ERROR - Don't know why.]
Unable to bracket root: (1e-4 .. 199261560.80331)</code></pre>
<h2 id="useful-links">Useful links</h2>
<p>http://nullprogram.com/blog/2009/06/23/ - Walks you through useful Calc commands - data formats like hex, complex numbers, HMS; matrix division; plotting graphs with a few keystrokes!; unit conversion.</p>
<p>https://truongnghiem.wordpress.com/common-calculations-in-emacscalc/ - showed me how to automatically recompute an expression by setting different values to a variable.</p>

<div class="info">Created: August  6, 2015</div>
<div class="info">Last modified: February 17, 2018</div>
<div class="info">Status: in-progress notes</div>
<div class="info"><b>Tags</b>: notes, emacs</div>

<br />
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'spkrationalitytrainingground'; // required: replace example with your forum shortname
    var disqus_identifier = '/Emacs-Learning.html';
    var disqus_title = 'Emacs Learning';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        </div>
        <div id="footer">
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>
    </body>
</html>
